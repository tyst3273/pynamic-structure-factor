this is the major version before i added incoherent scattering.